# P.I.S.D.A. - Комплексная производственная CMS система

## Описание
P.I.S.D.A. (Platform for Integrated System of Document Automation) - это комплексная CMS система для управления производственными процессами на базе Node.js с React клиентом. 

### Основные направления:
- **Управление персоналом** - сотрудники, отделы, участки, смены, графики работы
- **Ремонты и техобслуживание** - планирование, учет, отчеты по ремонтным работам
- **Учет оборудования** - приборы, параметры установок, техническое состояние
- **Планирование мероприятий** - календарь, задачи, контроль выполнения
- **Документооборот** - отчеты, акты, таблицы, печатные формы
- **Аналитика** - dashboards, статистика, KPI

## Архитектура

### Серверная часть (SERVER/)
- **Node.js + Express** - веб-сервер
- **JWT** - аутентификация и авторизация
- **Модульная архитектура** - каждый инструмент в отдельной папке
- **Файловая БД** - JSON файлы для хранения данных
- **Role-based access control** - система ролей и прав доступа

### Клиентская часть (WEB/)
- **React 18** - пользовательский интерфейс
- **React Router** - маршрутизация
- **React Query** - управление состоянием
- **Tailwind CSS** - стилизация
- **Lucide React** - иконки

## Система ролей

- **Гость** - базовые права для неавторизованных пользователей (никаких)
- **Пользователь** - доступ к настроенным сервисам
- **Редактор** - управление печатными формами, документами, загрузка контента
- **Администратор** - полный доступ, настройка прав, управление пользователями

## Инструменты

### 1. Авторизация (`/auth`)
- Управление пользователями с расширенными профилями
- Назначение ролей и проверка статуса сотрудника
- Интеграция с модулем сотрудников
- **Поля профиля**: ФИО, год рождения, дата трудоустройства, отдел/участок
- **Доступ**: все роли

### 2. Печатные формы (`/print-forms`)
- Создание и редактирование печатных форм
- HTML-шаблоны с подстановкой переменных
- Предварительный просмотр документов
- Экспорт в PDF/DOC/XLSX
- Отправка на печать
- **Доступ**: editor, admin

### 3. Управление персоналом (`/employees`)
- **Сотрудники**: ФИО, год рождения, дата трудоустройства, дата увольнения
- **Статусы**: работает, уволен, в отпуске, на больничном
- **Привязка к структуре**: отдел, участок
- **Интеграция**: создание учетных записей, использование в других модулях
- **Доступ**: editor, admin

### 4. Структура предприятия (`/structure`)
- **Иерархия**: площадки → отделы → участки
- **Управление подразделениями**: создание, редактирование, архивирование
- **Назначение ответственных**: руководители отделов и участков
- **Интеграция**: используется во всех модулях для группировки
- **Доступ**: editor, admin

### 5. Управление сменами (`/shifts`)
- **Создание смен**: привязка к участкам
- **Назначение сотрудников**: из списка сотрудников участка
- **Типы смен**: дневная, ночная, суточная, нестандартная
- **Календарное планирование**: интеграция с календарем
- **Доступ**: editor, admin

### 6. Календарь-планировщик (`/calendar`)
- **Визуальное планирование**: календарная сетка
- **Создание графиков работы**: смены, ремонты, мероприятия
- **Типы событий**: плановые, внеплановые, периодические
- **Уведомления**: напоминания о предстоящих событиях
- **Экспорт графиков**: печать календарей
- **Доступ**: user, editor, admin

### 7. Учет оборудования (`/equipment`)
- **Реестр приборов**: наименование, тип, серийный номер
- **Параметры установок**: технические характеристики
- **Локация**: привязка к отделам/участкам
- **История**: ремонты, обслуживание, перемещения
- **Статусы**: в работе, на ремонте, списано
- **Доступ**: user, editor, admin

### 8. Техническое обслуживание (`/maintenance`)
- **Планы ТО**: периодичность, виды работ
- **Календарное планирование**: интеграция с календарем
- **Назначение исполнителей**: из списка сотрудников
- **Чек-листы**: проверочные списки для ТО
- **Отчеты**: акты выполненных работ
- **Доступ**: user, editor, admin

### 9. Управление ремонтами (`/repairs`)
- **Заявки на ремонт**: описание неисправности, приоритет
- **Планирование**: назначение даты, исполнителей, материалов
- **Типы ремонтов**: плановый, аварийный, профилактический
- **Учет материалов**: запчасти, расходники
- **Контроль выполнения**: статусы, сроки
- **Доступ**: user, editor, admin

### 10. Отчеты и аналитика (`/reports`)
- **Отчеты по персоналу**: списки, графики работы
- **Отчеты по оборудованию**: состояние, ремонты, ТО
- **Производственные отчеты**: выполнение планов
- **Акты выполненных работ**: ремонты, ТО, мероприятия
- **Экспорт**: PDF, Excel, Word
- **Доступ**: user, editor, admin

## Быстрый старт

### Требования
- Node.js 18+
- npm или yarn

### Установка

1. **Клонирование репозитория**
```bash
git clone https://github.com/your-username/P.I.S.D.A.git
cd P.I.S.D.A
```

2. **Установка зависимостей**
```bash
# Серверные зависимости
cd SERVER
npm install

# Клиентские зависимости
cd ../WEB
npm install
```

3. **Запуск в режиме разработки**
```bash
# Из корневой папки проекта
npm start          # Запуск только сервера
npm run dev:all    # Запуск сервера + клиента
```

4. **Доступ к системе**
- **URL**: http://localhost:3000
- **Сервер**: http://localhost:3001
- **Данные по умолчанию**: admin/admin123

## Структура проекта

```
P.I.S.D.A/
├── SERVER/                 # Серверная часть
│   ├── app.js             # Основной серверный файл
│   ├── auth/              # Система авторизации
│   ├── print-forms/       # Инструмент печатных форм
│   ├── storage/           # Файловое хранилище
│   └── tools-config.json  # Конфигурация инструментов
├── WEB/                   # Клиентская часть
│   ├── src/
│   │   ├── App.js         # Основной компонент
│   │   ├── auth/          # Компоненты авторизации
│   │   ├── print-forms/   # Компоненты печатных форм
│   │   ├── components/    # Общие компоненты
│   │   ├── contexts/      # React контексты
│   │   ├── pages/         # Страницы
│   │   └── services/      # API сервисы
│   └── public/            # Статические файлы
├── README.md              # Основная документация
├── QUICKSTART.md          # Быстрый старт
├── DASHBOARD.md           # Документация дашборда
└── PRINT_FORMS_README.md  # Документация печатных форм
```

## API Endpoints

### Авторизация
- `POST /api/auth/login` - вход в систему
- `GET /api/auth/verify` - проверка токена
- `GET /api/auth/profile` - профиль пользователя
- `GET /api/auth/users` - список пользователей (admin)
- `PUT /api/auth/users/:id` - обновление пользователя (admin)

### Инструменты
- `GET /api/tools` - список доступных инструментов
- `GET /api/tools/manage` - управление инструментами (admin)

### Печатные формы
- `GET /api/print-forms/forms` - список форм
- `POST /api/print-forms/forms` - создание формы
- `PUT /api/print-forms/forms/:id` - обновление формы
- `DELETE /api/print-forms/forms/:id` - удаление формы
- `POST /api/print-forms/forms/:id/export` - экспорт документа
- `POST /api/print-forms/forms/:id/print` - печать документа

## Разработка

### Добавление нового инструмента

1. **Создать папку инструмента в SERVER/**
```
SERVER/my-tool/
├── config.json    # Конфигурация
├── controller.js  # Логика
└── routes.js      # API роуты
```

2. **Создать компоненты в WEB/src/my-tool/**
```
WEB/src/my-tool/
├── MyTool.js      # Основной компонент
└── components/    # Подкомпоненты
```

3. **Добавить роуты в App.js**
```javascript
<Route path="/my-tool/*" element={<MyTool />} />
```

4. **Обновить tools-config.json**
```json
{
  "tools": {
    "my-tool": {
      "active": true,
      "permissions": ["editor", "admin"],
      "title": "Мой инструмент",
      "description": "Описание инструмента",
      "order": 3
    }
  }
}
```

### Переменные окружения

Создайте файл `.env` в корне проекта:

```env
# Сервер
PORT=3001
NODE_ENV=development

# JWT
JWT_SECRET=your-secret-key
JWT_EXPIRES_IN=24h

# Клиент
REACT_APP_API_URL=http://localhost:3001/api
```

## Лицензия

MIT License

## Поддержка

Для вопросов и предложений создавайте Issues в GitHub репозитории.

## Планы развития

- [ ] Система уведомлений
- [ ] Рабочие процессы (workflows)
- [ ] Интеграция с внешними API
- [ ] Мобильное приложение
- [ ] Docker контейнеризация
- [ ] Тесты и CI/CD
- [ ] Многоязычность
- [ ] Темная/светлая тема
- [ ] Экспорт/импорт данных
- [ ] Система резервного копирования 