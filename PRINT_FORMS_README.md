# Инструмент печатных форм

## Описание
Инструмент управления печатными формами для экспорта данных в документы и печати. Позволяет создавать, редактировать и использовать HTML-шаблоны для генерации документов.

## Функциональность

### Основные возможности:
- ✅ Создание и редактирование печатных форм
- ✅ Настройка полей формы (текст, число, дата, многострочный текст)
- ✅ HTML-шаблоны с подстановкой переменных
- ✅ Предварительный просмотр документов
- ✅ Экспорт в различные форматы (PDF, DOC, XLSX)
- ✅ Отправка на печать
- ✅ Управление настройками страницы (размер, ориентация, отступы)

### Роли доступа:
- **Редактор (editor)**: Создание, редактирование, просмотр форм
- **Администратор (admin)**: Полный доступ + настройки системы

## Структура проекта

### Серверная часть (`SERVER/print-forms/`):
```
print-forms/
├── config.json          # Конфигурация инструмента
├── controller.js        # Логика обработки запросов
├── routes.js           # API роуты
└── data/               # Данные форм
    ├── forms.json      # Список печатных форм
    └── templates/      # Шаблоны документов
```

### Клиентская часть (`WEB/src/print-forms/`):
```
print-forms/
├── PrintFormsTool.js   # Основной компонент инструмента
└── components/         # Компоненты интерфейса
    ├── FormsList.js    # Список форм
    ├── FormEditor.js   # Редактор форм
    └── FormPreview.js  # Предварительный просмотр
```

## API Endpoints

### Основные операции:
- `GET /api/print-forms/forms` - Получение списка форм
- `GET /api/print-forms/forms/:id` - Получение формы по ID
- `POST /api/print-forms/forms` - Создание новой формы
- `PUT /api/print-forms/forms/:id` - Обновление формы
- `DELETE /api/print-forms/forms/:id` - Удаление формы

### Экспорт и печать:
- `GET /api/print-forms/forms/:id/preview` - Предварительный просмотр
- `POST /api/print-forms/forms/:id/export` - Экспорт документа
- `POST /api/print-forms/forms/:id/print` - Печать документа

## Использование

### Создание формы:
1. Перейдите в раздел "Печатные формы"
2. Нажмите "Создать форму"
3. Заполните основную информацию (название, описание)
4. Добавьте поля формы (текст, дата, число и т.д.)
5. Создайте HTML-шаблон с переменными `{field_name}`
6. Сохраните форму

### Предварительный просмотр:
1. Выберите форму из списка
2. Нажмите "Предварительный просмотр"
3. Заполните данные в форме
4. Увидите результат в реальном времени

### Экспорт и печать:
1. В режиме предварительного просмотра
2. Заполните необходимые данные
3. Нажмите "Экспорт" для скачивания документа
4. Или "Печать" для отправки на принтер

## Пример HTML-шаблона

```html
<html>
<body>
  <h1>Акт выполненных работ №{number}</h1>
  <p>Дата: {date}</p>
  <p>Исполнитель: {performer}</p>
  <p>Заказчик: {customer}</p>
  <p>Описание работ: {description}</p>
  <p>Сумма: {amount} руб.</p>
</body>
</html>
```

## Настройки страницы

- **Размер**: A4, A3, A5, Letter
- **Ориентация**: Книжная, Альбомная
- **Отступы**: Настраиваемые отступы со всех сторон (мм)

## Типы полей

- **text** - Однострочный текст
- **number** - Числовое значение
- **date** - Дата
- **textarea** - Многострочный текст
- **select** - Выбор из списка

## Планы развития

- [ ] Поддержка изображений в шаблонах
- [ ] Генерация PDF с помощью puppeteer
- [ ] Экспорт в Excel с формулами
- [ ] Массовая печать документов
- [ ] Шаблоны по умолчанию
- [ ] Версионирование форм
- [ ] Экспорт/импорт конфигураций форм

## Технические детали

### Зависимости сервера:
- `fs-extra` - Работа с файловой системой
- `express` - Веб-сервер

### Зависимости клиента:
- `react-query` - Управление состоянием
- `react-router-dom` - Маршрутизация
- `lucide-react` - Иконки
- `react-hot-toast` - Уведомления

### Безопасность:
- Аутентификация через JWT токены
- Проверка ролей доступа
- Валидация входных данных
- Санитизация HTML-шаблонов 